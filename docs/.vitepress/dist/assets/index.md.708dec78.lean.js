import{d as D,r as u,w as k,o as y,a as f,b as N,c as _,e as p,f as C,g as M,h as r,i as B,n as F,_ as $,j as h,k as x,u as I,l as j}from"./chunks/framework.3bead9bf.js";const A={class:"auto-pagination"},E={class:"auto-pagination_data-container"},L={key:0,class:"auto-pagination_main"},O=D({__name:"auto-pagination",props:{fetchData:{type:Function,default:()=>({list:[],total:0})},pageSizes:{type:Array,default:()=>[10,20,50,100]},defaultPageSize:{type:Number,default:20},prePageChanged:{type:Function,default:()=>!0},noPagination:{type:Boolean,default:!1},autoInit:{type:Boolean,default:!1}},setup(g,{expose:v}){const s=g,n=u(0),t=u(s.defaultPageSize),e=u(1),c=u([]),i=u(!1),d=u(1);k(()=>e.value,async(a,o)=>{if(d.value===a)return;await s.prePageChanged(a,o)===!0?(d.value=a,l()):e.value=o}),y(()=>{s.autoInit===!0&&P()});const z=a=>(e.value-1)*t.value+a+1,w=a=>{t.value=a,l()},l=async()=>{if(i.value=!0,s.noPagination===!1){let{list:a,total:o}=await s.fetchData({pageNo:e,pageSize:t});if(a.length>0||e.value===1)c.value=[],await F(),c.value=a,n.value=o,i.value=!1;else{if(e.value*t.value<=o)throw i.value=!1,new Error("接口返回数据异常");e.value=Math.ceil(o/t.value),l()}}else{let{list:a}=await s.fetchData();c.value=a,i.value=!1}},P=()=>{l()};return v({refresh:P,goFirstPage:()=>{e.value=1,l()},goLastPage:()=>{e.value=Math.ceil(n.value/t.value),l()},goNextPage:()=>{Math.ceil(n.value/t.value)===e.value?console.warn("已经是最后一页"):(e.value=e.value+1,l())},goPrevPage:()=>{e.value===1?console.warn("已经在第一页"):(e.value=e.value-1,l())},go:a=>{if(a===e.value){console.warn("已经在当前页");return}a>Math.ceil(n.value/t.value)?e.value=Math.ceil(n.value/t.value):e.value=a,l()}}),(a,o)=>{const m=f("el-pagination"),S=N("loading");return _(),p("div",A,[C((_(),p("div",E,[M(a.$slots,"default",{data:c.value,total:n.value,pageSize:t.value,currentPage:e.value,indexMethod:z},void 0,!0)])),[[S,i.value]]),g.noPagination===!1?(_(),p("div",L,[r(m,{"current-page":e.value,"onUpdate:currentPage":o[0]||(o[0]=b=>e.value=b),background:"","page-sizes":g.pageSizes,"page-size":t.value,layout:"total, sizes, prev, pager, next",total:n.value,small:"","onUpdate:pageSize":w},null,8,["current-page","page-sizes","page-size","total"])])):B("",!0)])}}});const T=$(O,[["__scopeId","data-v-0ec031e2"]]),U=h("h1",{id:"基础用法",tabindex:"-1"},[j("基础用法 "),h("a",{class:"header-anchor",href:"#基础用法","aria-label":'Permalink to "基础用法"'},"​")],-1),J={style:{height:"400px"}},W=JSON.parse('{"title":"基础用法","description":"","frontmatter":{},"headers":[],"relativePath":"index.md"}'),V={name:"index.md"},X=Object.assign(V,{setup(g){const v=u();y(()=>{v.value.goFirstPage()});const s=({pageNo:n,pageSize:t})=>({list:[{name:"张三",age:18},{name:"李四",age:19}],total:100});return(n,t)=>{const e=f("el-table-column"),c=f("el-table");return _(),p("div",null,[U,h("div",J,[r(I(T),{"fetch-data":s,ref_key:"pagination",ref:v},{default:x(({data:i,indexMethod:d})=>[r(c,{data:i},{default:x(()=>[r(e,{type:"index",index:d},null,8,["index"]),r(e,{prop:"name",label:"姓名"}),r(e,{prop:"age",label:"年龄"})]),_:2},1032,["data"])]),_:1},512)])])}}});export{W as __pageData,X as default};
